︠f252ecb0-7938-4daa-8e47-954f181cb91es︠
#http://sage.brandoncurtis.com/finite-difference.html#
import numpy
k = 0.1; step = 0; maxstep = 300; stepinterval = 5; t = 0; steps=[0,25,50,100,200,300]
sol = []; colors=['red','orange','yellow','green','blue','violet', 'purple']
T = numpy.array([10*floor(i/10).n() for i in range(0,100)]); T.shape=(10,10)
a = list_plot3d([], frame_aspect_ratio=[1,1,1])

def calcT(T,k):
    Tn = T.copy()
    for i in range(len(T)):
        for j in range(len(T[0])):
            if (i > 0): Tn[i][j] += k*(T[i-1][j]-T[i][j])
            else: pass             # insulated edge

            if (j > 0): Tn[i][j] += k*(T[i][j-1]-T[i][j])
            else: Tn[i][j] += 1    # heated edge

            if (i < len(T)-1): Tn[i][j] += k*(T[i+1][j]-T[i][j])
            else: pass             # insulated edge

            if (j < len(T[0])-1): Tn[i][j] += k*(T[i][j+1]-T[i][j])
            else: pass             # insulated edge
    T = Tn.copy()
    return T

while step <= maxstep:
    T = calcT(T=T,k=k)
    if (step%stepinterval ==0):
        sol.append(T)
    step += 1

for i in range(0,len(steps)):
    a += list_plot3d(sol[steps[i]/stepinterval], texture=colors[i], interpolation_type='spline')

@interact
def example(jmol=('Rotatable Plot', False), theta=(1.5*pi,(0,2*pi))):
    b = a.rotate((0,0,1), theta)
    show(a.rotate((0,0,1), 1.5*pi) if jmol else b, viewer='jmol' if jmol else 'tachyon')

︡0df472bb-3c1d-4da1-9e4e-132d3402f9a5︡{"stderr":"/ext/sage/sage-8.1/local/lib/python2.7/site-packages/matplotlib/cbook.py:137: MatplotlibDeprecationWarning: The matplotlib.delaunay module was deprecated in version 1.4. Use matplotlib.tri.Triangulation instead.\n  warnings.warn(message, mplDeprecation, stacklevel=1)\n"}︡{"interact":{"controls":[{"control_type":"checkbox","default":false,"label":"Rotatable Plot","readonly":false,"var":"jmol"},{"animate":true,"control_type":"slider","default":375,"display_value":true,"label":"theta","vals":["0","0.004*pi","0.008*pi","0.012*pi","0.016*pi","0.02*pi","0.024*pi","0.028*pi","0.032*pi","0.036000000000000004*pi","0.04000000000000001*pi","0.04400000000000001*pi","0.048000000000000015*pi","0.05200000000000002*pi","0.05600000000000002*pi","0.060000000000000026*pi","0.06400000000000003*pi","0.06800000000000003*pi","0.07200000000000004*pi","0.07600000000000004*pi","0.08000000000000004*pi","0.08400000000000005*pi","0.08800000000000005*pi","0.09200000000000005*pi","0.09600000000000006*pi","0.10000000000000006*pi","0.10400000000000006*pi","0.10800000000000007*pi","0.11200000000000007*pi","0.11600000000000008*pi","0.12000000000000008*pi","0.12400000000000008*pi","0.12800000000000009*pi","0.1320000000000001*pi","0.1360000000000001*pi","0.1400000000000001*pi","0.1440000000000001*pi","0.1480000000000001*pi","0.1520000000000001*pi","0.1560000000000001*pi","0.16000000000000011*pi","0.16400000000000012*pi","0.16800000000000012*pi","0.17200000000000013*pi","0.17600000000000013*pi","0.18000000000000013*pi","0.18400000000000014*pi","0.18800000000000014*pi","0.19200000000000014*pi","0.19600000000000015*pi","0.20000000000000015*pi","0.20400000000000015*pi","0.20800000000000016*pi","0.21200000000000016*pi","0.21600000000000016*pi","0.22000000000000017*pi","0.22400000000000017*pi","0.22800000000000017*pi","0.23200000000000018*pi","0.23600000000000018*pi","0.24000000000000019*pi","0.2440000000000002*pi","0.2480000000000002*pi","0.25200000000000017*pi","0.25600000000000017*pi","0.2600000000000002*pi","0.2640000000000002*pi","0.2680000000000002*pi","0.2720000000000002*pi","0.2760000000000002*pi","0.2800000000000002*pi","0.2840000000000002*pi","0.2880000000000002*pi","0.2920000000000002*pi","0.2960000000000002*pi","0.3000000000000002*pi","0.3040000000000002*pi","0.3080000000000002*pi","0.3120000000000002*pi","0.3160000000000002*pi","0.32000000000000023*pi","0.32400000000000023*pi","0.32800000000000024*pi","0.33200000000000024*pi","0.33600000000000024*pi","0.34000000000000025*pi","0.34400000000000025*pi","0.34800000000000025*pi","0.35200000000000026*pi","0.35600000000000026*pi","0.36000000000000026*pi","0.36400000000000027*pi","0.36800000000000027*pi","0.3720000000000003*pi","0.3760000000000003*pi","0.3800000000000003*pi","0.3840000000000003*pi","0.3880000000000003*pi","0.3920000000000003*pi","0.3960000000000003*pi","0.4000000000000003*pi","0.4040000000000003*pi","0.4080000000000003*pi","0.4120000000000003*pi","0.4160000000000003*pi","0.4200000000000003*pi","0.4240000000000003*pi","0.4280000000000003*pi","0.43200000000000033*pi","0.43600000000000033*pi","0.44000000000000034*pi","0.44400000000000034*pi","0.44800000000000034*pi","0.45200000000000035*pi","0.45600000000000035*pi","0.46000000000000035*pi","0.46400000000000036*pi","0.46800000000000036*pi","0.47200000000000036*pi","0.47600000000000037*pi","0.48000000000000037*pi","0.4840000000000004*pi","0.4880000000000004*pi","0.4920000000000004*pi","0.4960000000000004*pi","0.5000000000000003*pi","0.5040000000000003*pi","0.5080000000000003*pi","0.5120000000000003*pi","0.5160000000000003*pi","0.5200000000000004*pi","0.5240000000000004*pi","0.5280000000000004*pi","0.5320000000000004*pi","0.5360000000000004*pi","0.5400000000000004*pi","0.5440000000000004*pi","0.5480000000000004*pi","0.5520000000000004*pi","0.5560000000000004*pi","0.5600000000000004*pi","0.5640000000000004*pi","0.5680000000000004*pi","0.5720000000000004*pi","0.5760000000000004*pi","0.5800000000000004*pi","0.5840000000000004*pi","0.5880000000000004*pi","0.5920000000000004*pi","0.5960000000000004*pi","0.6000000000000004*pi","0.6040000000000004*pi","0.6080000000000004*pi","0.6120000000000004*pi","0.6160000000000004*pi","0.6200000000000004*pi","0.6240000000000004*pi","0.6280000000000004*pi","0.6320000000000005*pi","0.6360000000000005*pi","0.6400000000000005*pi","0.6440000000000005*pi","0.6480000000000005*pi","0.6520000000000005*pi","0.6560000000000005*pi","0.6600000000000005*pi","0.6640000000000005*pi","0.6680000000000005*pi","0.6720000000000005*pi","0.6760000000000005*pi","0.6800000000000005*pi","0.6840000000000005*pi","0.6880000000000005*pi","0.6920000000000005*pi","0.6960000000000005*pi","0.7000000000000005*pi","0.7040000000000005*pi","0.7080000000000005*pi","0.7120000000000005*pi","0.7160000000000005*pi","0.7200000000000005*pi","0.7240000000000005*pi","0.7280000000000005*pi","0.7320000000000005*pi","0.7360000000000005*pi","0.7400000000000005*pi","0.7440000000000005*pi","0.7480000000000006*pi","0.7520000000000006*pi","0.7560000000000006*pi","0.7600000000000006*pi","0.7640000000000006*pi","0.7680000000000006*pi","0.7720000000000006*pi","0.7760000000000006*pi","0.7800000000000006*pi","0.7840000000000006*pi","0.7880000000000006*pi","0.7920000000000006*pi","0.7960000000000006*pi","0.8000000000000006*pi","0.8040000000000006*pi","0.8080000000000006*pi","0.8120000000000006*pi","0.8160000000000006*pi","0.8200000000000006*pi","0.8240000000000006*pi","0.8280000000000006*pi","0.8320000000000006*pi","0.8360000000000006*pi","0.8400000000000006*pi","0.8440000000000006*pi","0.8480000000000006*pi","0.8520000000000006*pi","0.8560000000000006*pi","0.8600000000000007*pi","0.8640000000000007*pi","0.8680000000000007*pi","0.8720000000000007*pi","0.8760000000000007*pi","0.8800000000000007*pi","0.8840000000000007*pi","0.8880000000000007*pi","0.8920000000000007*pi","0.8960000000000007*pi","0.9000000000000007*pi","0.9040000000000007*pi","0.9080000000000007*pi","0.9120000000000007*pi","0.9160000000000007*pi","0.9200000000000007*pi","0.9240000000000007*pi","0.9280000000000007*pi","0.9320000000000007*pi","0.9360000000000007*pi","0.9400000000000007*pi","0.9440000000000007*pi","0.9480000000000007*pi","0.9520000000000007*pi","0.9560000000000007*pi","0.9600000000000007*pi","0.9640000000000007*pi","0.9680000000000007*pi","0.9720000000000008*pi","0.9760000000000008*pi","0.9800000000000008*pi","0.9840000000000008*pi","0.9880000000000008*pi","0.9920000000000008*pi","0.9960000000000008*pi","1.0000000000000007*pi","1.0040000000000007*pi","1.0080000000000007*pi","1.0120000000000007*pi","1.0160000000000007*pi","1.0200000000000007*pi","1.0240000000000007*pi","1.0280000000000007*pi","1.0320000000000007*pi","1.0360000000000007*pi","1.0400000000000007*pi","1.0440000000000007*pi","1.0480000000000007*pi","1.0520000000000007*pi","1.0560000000000007*pi","1.0600000000000007*pi","1.0640000000000007*pi","1.0680000000000007*pi","1.0720000000000007*pi","1.0760000000000007*pi","1.0800000000000007*pi","1.0840000000000007*pi","1.0880000000000007*pi","1.0920000000000007*pi","1.0960000000000008*pi","1.1000000000000008*pi","1.1040000000000008*pi","1.1080000000000008*pi","1.1120000000000008*pi","1.1160000000000008*pi","1.1200000000000008*pi","1.1240000000000008*pi","1.1280000000000008*pi","1.1320000000000008*pi","1.1360000000000008*pi","1.1400000000000008*pi","1.1440000000000008*pi","1.1480000000000008*pi","1.1520000000000008*pi","1.1560000000000008*pi","1.1600000000000008*pi","1.1640000000000008*pi","1.1680000000000008*pi","1.1720000000000008*pi","1.1760000000000008*pi","1.1800000000000008*pi","1.1840000000000008*pi","1.1880000000000008*pi","1.1920000000000008*pi","1.1960000000000008*pi","1.2000000000000008*pi","1.2040000000000008*pi","1.2080000000000009*pi","1.2120000000000009*pi","1.2160000000000009*pi","1.2200000000000009*pi","1.2240000000000009*pi","1.2280000000000009*pi","1.2320000000000009*pi","1.2360000000000009*pi","1.2400000000000009*pi","1.2440000000000009*pi","1.2480000000000009*pi","1.252000000000001*pi","1.256000000000001*pi","1.260000000000001*pi","1.264000000000001*pi","1.268000000000001*pi","1.272000000000001*pi","1.276000000000001*pi","1.280000000000001*pi","1.284000000000001*pi","1.288000000000001*pi","1.292000000000001*pi","1.296000000000001*pi","1.300000000000001*pi","1.304000000000001*pi","1.308000000000001*pi","1.312000000000001*pi","1.316000000000001*pi","1.320000000000001*pi","1.324000000000001*pi","1.328000000000001*pi","1.332000000000001*pi","1.336000000000001*pi","1.340000000000001*pi","1.344000000000001*pi","1.348000000000001*pi","1.352000000000001*pi","1.356000000000001*pi","1.360000000000001*pi","1.364000000000001*pi","1.368000000000001*pi","1.372000000000001*pi","1.376000000000001*pi","1.380000000000001*pi","1.384000000000001*pi","1.388000000000001*pi","1.392000000000001*pi","1.396000000000001*pi","1.400000000000001*pi","1.404000000000001*pi","1.408000000000001*pi","1.412000000000001*pi","1.416000000000001*pi","1.420000000000001*pi","1.424000000000001*pi","1.428000000000001*pi","1.432000000000001*pi","1.436000000000001*pi","1.440000000000001*pi","1.444000000000001*pi","1.448000000000001*pi","1.452000000000001*pi","1.456000000000001*pi","1.460000000000001*pi","1.464000000000001*pi","1.468000000000001*pi","1.472000000000001*pi","1.476000000000001*pi","1.480000000000001*pi","1.484000000000001*pi","1.488000000000001*pi","1.492000000000001*pi","1.496000000000001*pi","1.500000000000001*pi","1.5040000000000011*pi","1.5080000000000011*pi","1.5120000000000011*pi","1.5160000000000011*pi","1.5200000000000011*pi","1.5240000000000011*pi","1.5280000000000011*pi","1.5320000000000011*pi","1.5360000000000011*pi","1.5400000000000011*pi","1.5440000000000011*pi","1.5480000000000012*pi","1.5520000000000012*pi","1.5560000000000012*pi","1.5600000000000012*pi","1.5640000000000012*pi","1.5680000000000012*pi","1.5720000000000012*pi","1.5760000000000012*pi","1.5800000000000012*pi","1.5840000000000012*pi","1.5880000000000012*pi","1.5920000000000012*pi","1.5960000000000012*pi","1.6000000000000012*pi","1.6040000000000012*pi","1.6080000000000012*pi","1.6120000000000012*pi","1.6160000000000012*pi","1.6200000000000012*pi","1.6240000000000012*pi","1.6280000000000012*pi","1.6320000000000012*pi","1.6360000000000012*pi","1.6400000000000012*pi","1.6440000000000012*pi","1.6480000000000012*pi","1.6520000000000012*pi","1.6560000000000012*pi","1.6600000000000013*pi","1.6640000000000013*pi","1.6680000000000013*pi","1.6720000000000013*pi","1.6760000000000013*pi","1.6800000000000013*pi","1.6840000000000013*pi","1.6880000000000013*pi","1.6920000000000013*pi","1.6960000000000013*pi","1.7000000000000013*pi","1.7040000000000013*pi","1.7080000000000013*pi","1.7120000000000013*pi","1.7160000000000013*pi","1.7200000000000013*pi","1.7240000000000013*pi","1.7280000000000013*pi","1.7320000000000013*pi","1.7360000000000013*pi","1.7400000000000013*pi","1.7440000000000013*pi","1.7480000000000013*pi","1.7520000000000013*pi","1.7560000000000013*pi","1.7600000000000013*pi","1.7640000000000013*pi","1.7680000000000013*pi","1.7720000000000014*pi","1.7760000000000014*pi","1.7800000000000014*pi","1.7840000000000014*pi","1.7880000000000014*pi","1.7920000000000014*pi","1.7960000000000014*pi","1.8000000000000014*pi","1.8040000000000014*pi","1.8080000000000014*pi","1.8120000000000014*pi","1.8160000000000014*pi","1.8200000000000014*pi","1.8240000000000014*pi","1.8280000000000014*pi","1.8320000000000014*pi","1.8360000000000014*pi","1.8400000000000014*pi","1.8440000000000014*pi","1.8480000000000014*pi","1.8520000000000014*pi","1.8560000000000014*pi","1.8600000000000014*pi","1.8640000000000014*pi","1.8680000000000014*pi","1.8720000000000014*pi","1.8760000000000014*pi","1.8800000000000014*pi","1.8840000000000015*pi","1.8880000000000015*pi","1.8920000000000015*pi","1.8960000000000015*pi","1.9000000000000015*pi","1.9040000000000015*pi","1.9080000000000015*pi","1.9120000000000015*pi","1.9160000000000015*pi","1.9200000000000015*pi","1.9240000000000015*pi","1.9280000000000015*pi","1.9320000000000015*pi","1.9360000000000015*pi","1.9400000000000015*pi","1.9440000000000015*pi","1.9480000000000015*pi","1.9520000000000015*pi","1.9560000000000015*pi","1.9600000000000015*pi","1.9640000000000015*pi","1.9680000000000015*pi","1.9720000000000015*pi","1.9760000000000015*pi","1.9800000000000015*pi","1.9840000000000015*pi","1.9880000000000015*pi","1.9920000000000015*pi","1.9960000000000016*pi","2*pi"],"var":"theta","width":null}],"flicker":false,"id":"ad5e9d95-872c-41c0-bb2b-12c376267867","layout":[[["jmol",12,null]],[["theta",12,null]],[["",12,null]]],"style":"None"}}︡{"done":true}︡









